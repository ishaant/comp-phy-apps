% Q2 (Ex:13)
clear all

n=3;

G=4*pi^2;
m1=1;
m2=1;
m3=1;


x=[3.3030197;-3.3030197;0];
y=[-0.82771837 ;0.82771837;0 ];
vx=[1.587433767;1.587433767;-3.174867535];
vy=[1.47221479;1.47221479;-2.94442961];



X0=[x(1);y(1);vx(1);vy(1);x(2);y(2);vx(2);vy(2);x(3);y(3);vx(3);vy(3)];


R12=@(X) sqrt((X(1)-X(5))^2+(X(2)-X(6))^2);
R23=@(X) sqrt((X(9)-X(5))^2+(X(10)-X(6))^2);
R13=@(X) sqrt((X(1)-X(9))^2+(X(2)-X(10))^2);

dv1x=@(X) -G*m2*(X(1)-X(5))/R12(X)^3-G*m3*(X(1)-X(9))/R13(X)^3;
dv1y=@(X) -G*m2*(X(2)-X(6))/R12(X)^3-G*m3*(X(2)-X(10))/R13(X)^3;
dv2x=@(X) -G*m1*(X(5)-X(1))/R12(X)^3-G*m3*(X(5)-X(9))/R23(X)^3;
dv2y=@(X) -G*m1*(X(6)-X(2))/R12(X)^3-G*m3*(X(6)-X(10))/R23(X)^3;
dv3x=@(X) -G*m1*(X(9)-X(1))/R13(X)^3-G*m2*(X(9)-X(5))/R23(X)^3;
dv3y=@(X) -G*m1*(X(10)-X(2))/R13(X)^3-G*m2*(X(10)-X(6))/R23(X)^3;


force=@(X) [X(3);X(4); dv1x(X); dv1y(X);X(7);X(8); dv2x(X); dv2y(X);X(11);X(12); dv3x(X); dv3y(X)];


F = @(s,t) force(s);

h = 0.01;

t_f = 10;

[Y,t] = RK3(F,X0,t_f,1000);
% 

     for j=1:n
         plot(Y(4*(j-1)+1,:),Y(4*(j-1)+2,:),'.')
         hold on
     end